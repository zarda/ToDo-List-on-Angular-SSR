<div class="todo-controls-container">
  @if (store.todos().length >= 50) {
    <mat-form-field class="search-field" appearance="outline">
      <mat-label>Search To-Dos</mat-label>
      <input
        matInput
        [ngModel]="store.searchTerm()"
        (ngModelChange)="store.setSearchTerm($event)"
        placeholder="e.g., finish report" />
      <button
        mat-icon-button
        matSuffix
        (click)="store.setSearchTerm('')"
        [attr.aria-label]="'Clear search'"
        [class.hidden]="!store.searchTerm()">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
  }
</div>

<div class="action-buttons">
  <mat-button-toggle [checked]="store.hideCompleted()" (change)="store.setHideCompleted($event.source.checked)" matTooltip="Hide completed to-dos">
    @if (store.hideCompleted()) {
      <mat-icon>visibility</mat-icon>
    } @else {
      <mat-icon>visibility_off</mat-icon>
    }
  </mat-button-toggle>

  <mat-chip-listbox class="sort-controls" [value]="store.sortBy()" (change)="store.setSortBy($event.value)" aria-label="Sort by">
    <mat-chip-option value="order" matTooltip="Sort by order">
      <mat-icon>drag_handle</mat-icon>
    </mat-chip-option>
    <mat-chip-option value="createdAt" matTooltip="Sort by date added">
      <mat-icon>date_range</mat-icon>
    </mat-chip-option>
    <mat-chip-option value="dueDate" matTooltip="Sort by due date">
      <mat-icon>event</mat-icon>
    </mat-chip-option>
  </mat-chip-listbox>

  <button mat-raised-button color="warn" (click)="store.clearCompleted()" [disabled]="!store.hasCompletedTodos()" matTooltip="Permanently delete all completed to-dos">
    <mat-icon>delete_sweep</mat-icon>
  </button>
</div>